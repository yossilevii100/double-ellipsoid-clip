<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>The Double-Ellipsoid Geometry of CLIP</title>

  <!-- Fonts and Icons -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&family=Roboto:wght@400;500&display=swap" rel="stylesheet">
  <script src="https://kit.fontawesome.com/ad96f96272.js" crossorigin="anonymous"></script>

  <style>
    body { font-family: 'Roboto', sans-serif; background: #fafafa; color: #222; margin:0; padding-top:70px; overflow-x:hidden; }
    h1, h2, h3 { font-family: 'Poppins', sans-serif; }
    a { color: #4b0082; text-decoration: none; position: relative; transition: 0.3s; }
    a:hover { color: #a259ff; }
    a::after { content: ''; position: absolute; width: 0; height: 2px; bottom: -2px; left: 0; background-color: #a259ff; transition: width 0.3s ease-in-out; }
    a:hover::after { width: 100%; }

    /* Top Navigation */
    .topnav { position: fixed; top: 0; width: 100%; background: #a259ff; display: flex; justify-content: center; z-index: 1000; box-shadow: 0 4px 6px rgba(0,0,0,0.1); padding: 10px 0; }
    .topnav a { color: white; padding: 10px 20px; text-align: center; font-weight:600; font-size:1rem; transition: 0.3s; }
    .topnav a:hover { background: rgba(255,255,255,0.2); border-radius:5px; }

    /* Section styling */
    section { width: 100%; padding: 60px 5%; margin: 20px 0; border-radius: 20px; box-shadow: 0 10px 20px rgba(162,89,255,0.15); transition: transform 0.3s, box-shadow 0.3s; background: linear-gradient(145deg, #ffffff, #f2f0ff); }
    section:hover { transform: translateY(-5px); box-shadow: 0 20px 40px rgba(162,89,255,0.2); }
    .section-content { max-width:1000px; margin:auto; }
    h1 { font-size: 3rem; font-weight: 800; text-align:center; color:#a259ff; }
    h2 { font-size: 2rem; color:#4b0082; margin-bottom:20px; text-align:center; }
    p, li { font-size:1.1rem; line-height:1.6; color:#333; }

    /* Header portraits */
    .authors-container { display: flex; justify-content: center; gap: 60px; margin-top: 15px; flex-wrap: wrap; align-items: center; }
    .authors-left, .authors-right { display: flex; gap: 40px; align-items: center; }
    .author { display: flex; flex-direction: column; align-items: center; transition: transform 0.3s; }
    .author img { width: 70px; height: 70px; border-radius: 50%; object-fit: cover; margin-bottom: 5px; transition: transform 0.3s; }
    .author:hover img { transform: scale(1.15); }
    .author a { text-decoration: none; font-weight: 600; color: #4b0082; }
    .author a:hover::after { width: 100%; }
    .divider-vertical { width: 2px; background: #a259ff; height: 70px; border-radius: 2px; }

    /* Aligned button row */
    .btn-row { display:flex; justify-content:center; align-items:center; flex-wrap:wrap; gap:10px; margin-top:15px; }
    .btn-custom { display:flex; align-items:center; gap:8px; padding:6px 16px; background:#a259ff; color:#fff; border:none; border-radius:8px; font-weight:600; transition:0.3s; cursor:pointer; text-decoration:none; height:36px; line-height:1; }
    .btn-custom:hover { background:#6f2da8; transform: translateY(-2px); }
    .btn-custom img { height:20px; width:auto; display:block; }
    .btn-custom i { font-size:18px; line-height:1; display:block; }
    .btn-custom::after { display:none; }

    /* Abstract + Teaser split */
    .abstract-container { display: flex; flex-wrap: wrap; gap: 20px; align-items: flex-start; justify-content: center; }
    .abstract-text, .abstract-teaser-container { flex: 1 1 45%; min-width:300px; display:flex; flex-direction:column; }
    .abstract-teaser-container { align-items: center; }
    .abstract-teaser { width: 100%; height: auto; max-height: 100%; border-radius:15px; box-shadow:0 10px 20px rgba(162,89,255,0.2); cursor: pointer; transition: transform 0.3s; }
    .abstract-teaser:hover { transform: scale(1.02); }
    @media (max-width: 900px) { .abstract-text, .abstract-teaser-container { flex: 1 1 100%; } }

    /* Key insights grid */
    .insights-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; }
    .card-insight { background: linear-gradient(145deg, #fff, #f0f0f5); border-radius: 20px; padding: 30px; box-shadow: 0 10px 20px rgba(162,89,255,0.2); transition: transform 0.3s, box-shadow 0.3s; cursor: pointer; position:relative; overflow:hidden; }
    .card-insight:hover { transform: translateY(-10px); box-shadow: 0 20px 40px rgba(162,89,255,0.3); }
    .card-insight h3 { color: #a259ff; }
    #ellipsoidCanvas { position:absolute; top:0; left:0; width:100%; height:100%; pointer-events:none; border-radius:20px; }

    /* Media and code */
    .poster { width:100%; max-width:1000px; border-radius:20px; box-shadow:0 0 30px rgba(162,89,255,0.15); margin:20px 0; display:block; margin-left:auto; margin-right:auto; }
    iframe { border-radius:20px; max-width:100%; width:100%; height:450px; box-shadow:0 0 30px rgba(162,89,255,0.15); margin-top:20px; display:block; margin-left:auto; margin-right:auto; }
    pre { background:#eaeaea; padding:20px; border-radius:15px; overflow-x:auto; color:#222; }

    footer { text-align:center; padding:50px 20px; font-size:0.95rem; color:#555; }
  </style>
</head>
<body>

  <!-- Top Navigation -->
  <div class="topnav">
    <a href="#hero">Home</a>
    <a href="#abstract">Abstract</a>
    <a href="#insights">Key Insights</a>
    <a href="#colab">Colab Demo</a>
    <a href="#followup">Follow-up</a>
    <a href="#caltech">Caltech Talk</a>
    <a href="#bibtex">BibTeX</a>
  </div>

  <!-- Hero Section -->
  <section id="hero">
    <div class="section-content">
      <h1>The Double-Ellipsoid Geometry of CLIP</h1>
      <h2>ICML 2025</h2>

      <!-- Author portraits -->
      <div class="authors-container">
        <div class="authors-left">
          <div class="author">
            <a href="https://yossilevii100.github.io" target="_blank"><img src="../misc/yossi.jfif" alt="Meir Yossef Levi"></a>
            <a href="https://yossilevii100.github.io" target="_blank">Meir Yossef Levi</a>
          </div>
          <div class="author">
            <a href="https://guygilboa.net.technion.ac.il/" target="_blank"><img src="../misc/guy.png" alt="Guy Gilboa"></a>
            <a href="https://guygilboa.net.technion.ac.il/" target="_blank">Guy Gilboa</a>
          </div>
        </div>
        <div class="divider-vertical"></div>
        <div class="authors-right">
          <div class="author">
            <a href="https://www.technion.ac.il/en/" target="_blank"><img src="../misc/technion.png" alt="Technion" style="background:black; padding:5px; border-radius:50%;"></a>
            <a href="https://www.technion.ac.il/en/" target="_blank">Technion</a>
          </div>
        </div>
      </div>

      <!-- Aligned buttons row -->
      <div class="btn-row">
        <a class="btn-custom" href="https://arxiv.org/abs/2411.14517" target="_blank" rel="noopener"><img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/bc/ArXiv_logo_2022.svg/512px-ArXiv_logo_2022.svg.png" alt="ArXiv"> ArXiv</a>
        <a class="btn-custom" href="https://github.com/yossilevii100/double-ellipsoid-clip" target="_blank" rel="noopener"><i class="fab fa-github"></i> Code</a>
        <a class="btn-custom" href="https://www.youtube.com/watch?v=4nJCuGGfirw" target="_blank" rel="noopener"><i class="fas fa-video"></i> Presentation</a>
      </div>
    </div>
  </section>

  <!-- Abstract + Teaser Section -->
  <section id="abstract">
    <div class="section-content abstract-container">
      <div class="abstract-text">
        <h2>Abstract</h2>
        <p>Contrastive Language–Image Pre-Training (CLIP) is instrumental across many domains, yet its embedding geometry is not fully understood. We examine the <strong>raw (pre-normalized)</strong> features and show that image and text reside on <strong>linearly separable ellipsoid shells</strong>, both <strong>shifted away from the origin</strong>. We explain the benefits of this structure and introduce a notion of <em>conformity</em>, which closely matches cosine similarity to the modality mean. We further connect this geometry to the <em>modality gap</em> and the <em>narrow-cone</em> effect.</p>
      </div>
      <div class="abstract-teaser-container">
        <h2 style="margin-bottom:10px;">Abstract</h2>
        <img class="abstract-teaser" src="https://raw.githubusercontent.com/yossilevii100/double-ellipsoid-clip/main/misc/clip_poster.png" alt="Abstract Teaser" onclick="openImage(this.src)">
      </div>
    </div>
  </section>

  <!-- Key Insights Section -->
  <section id="insights">
    <div class="section-content">
      <h2>Key Insights</h2>
      <div class="insights-grid">
        <!-- Double Ellipsoid Card -->
        <div class="card-insight" id="double-ellipsoid-card">
          <h3>Double-Ellipsoid Geometry</h3>
          <p>Image and text features occupy distinct, shifted ellipsoid shells in the raw CLIP space; their separability explains the <em>modality gap</em> while their offset from the origin explains the <em>Narrow Cone Effect</em>.</p>
          <canvas id="ellipsoidCanvas"></canvas>
        </div>

        <!-- Other cards -->
        <div class="card-insight">
          <h3>Conformity ≈ Mean-Similarity</h3>
          <p>A sample's conformity—the average cosine similarity to all others—can be estimated by its cosine similarity to the modality mean.</p>
        </div>
        <div class="card-insight">
          <h3>Optimal Convergence</h3>
          <p>We found that in this position the alignment between the conformity distribution of text and images is optimal.</p>
        </div>
        <div class="card-insight">
          <h3>Practical Implications</h3>
          <p>Understanding this geometry motivates simple diagnostics and improved alignment methods in downstream tasks.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Colab Demo Section -->
  <section id="colab">
    <div class="section-content">
      <h2>Colab Demo</h2>
      <p>Try the analysis yourself using our Google Colab notebook:</p>
      <a class="btn-custom" href="https://colab.research.google.com/github/yossilevii100/double-ellipsoid-clip/blob/main/demo.ipynb" target="_blank"><i class="fab fa-google"></i> Open Colab Notebook</a>
    </div>
  </section>

  <!-- Follow-up Section -->
  <section id="followup">
    <div class="section-content">
      <h2>Follow-up Paper</h2>
      <p>Check out our follow-up paper analyzing CLIP in a probabilistic manner:</p>
      <a class="btn-custom" href="https://arxiv.org/abs/2505.06934" target="_blank"><i class="fas fa-file-alt"></i> Probabilistic CLIP Paper</a>
    </div>
  </section>

  <!-- Caltech Talk Section -->
  <section id="caltech">
    <div class="section-content">
      <h2>Caltech Talk</h2>
      <p>We presented our work in a talk at Caltech:</p>
      <iframe src="https://www.youtube.com/embed/YourVideoID" allowfullscreen></iframe>
    </div>
  </section>

  <!-- BibTeX Section -->
  <section id="bibtex">
    <div class="section-content">
      <h2>BibTeX</h2>
      <pre>
@inproceedings{levi2025double,
  title={The Double-Ellipsoid Geometry of CLIP},
  author={Levi, Meir Yossef and Gilboa, Guy},
  booktitle={ICML},
  year={2025}
}
      </pre>
    </div>
  </section>

  <footer>
    &copy; 2025 Meir Yossef Levi & Guy Gilboa | Technion
  </footer>

  <script>
    function openImage(src) {
      const w = window.open("");
      w.document.write('<img src="'+src+'" style="width:100%;height:100%;object-fit:contain;">');
    }

    // Ellipsoid animation
    const canvas = document.getElementById('ellipsoidCanvas');
    const ctx = canvas.getContext('2d');
    let width, height;
    function resize() { width=canvas.width=canvas.offsetWidth; height=canvas.height=canvas.offsetHeight; }
    resize(); window.addEventListener('resize', resize);
    const N=80; const particles=[];
    for(let i=0;i<N;i++){particles.push({x:Math.random()*width,y:Math.random()*height,vx:0,vy:0,type:i<N/2?'text':'image',color:i<N/2?'orange':'cyan',target:null,radius:4+Math.random()*3,trail:[]});}
    function setTargets(){
      const ellipsoidWidth=width/3; const ellipsoidHeight=height/2;
      particles.forEach(p=>{p.target=p.type==='text'?{x:width/4+(Math.random()-0.5)*ellipsoidWidth,y:height/2+(Math.random()-0.5)*ellipsoidHeight}:{x:3*width/4+(Math.random()-0.5)*ellipsoidWidth,y:height/2+(Math.random()-0.5)*ellipsoidHeight};});
    }
    setTargets();
    function animate(){
      ctx.clearRect(0,0,width,height);
      particles.forEach(p=>{
        p.vx+=(p.target.x-p.x)*0.02;p.vy+=(p.target.y-p.y)*0.02;p.vx*=0.85;p.vy*=0.85;p.x+=p.vx;p.y+=p.vy;
        p.trail.push({x:p.x,y:p.y});if(p.trail.length>10)p.trail.shift();
        ctx.beginPath();
        for(let i=0;i<p.trail.length-1;i++){ctx.moveTo(p.trail[i].x,p.trail[i].y);ctx.lineTo(p.trail[i+1].x,p.trail[i+1].y);}
        ctx.strokeStyle=p.color;ctx.globalAlpha=0.4;ctx.lineWidth=2;ctx.stroke();ctx.globalAlpha=1;
        ctx.beginPath();ctx.arc(p.x,p.y,p.radius,0,Math.PI*2);ctx.fillStyle=p.color;ctx.shadowColor=p.color;ctx.shadowBlur=10;ctx.fill();ctx.shadowBlur=0;
      });
      ctx.strokeStyle='rgba(255,255,255,0.2)';ctx.lineWidth=2;
      ctx.beginPath();ctx.ellipse(width/4,height/2,width/6,height/3,0,0,2*Math.PI);ctx.stroke();ctx.fillStyle='rgba(255,165,0,0.1)';ctx.fill();
      ctx.beginPath();ctx.ellipse(3*width/4,height/2,width/6,height/3,0,0,2*Math.PI);ctx.stroke();ctx.fillStyle='rgba(0,255,255,0.1)';ctx.fill();
      ctx.fillStyle='white';ctx.font='bold 18px Poppins';ctx.textAlign='center';ctx.fillText('Text Features',width/4,40);ctx.fillText('Image Features',3*width/4,40);
      requestAnimationFrame(animate);
    }
    animate();
  </script>

</body>
</html>
