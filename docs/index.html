<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="The Double-Ellipsoid Geometry of CLIP — ICML 2025 paper by Meir Yossef Levi &amp; Guy Gilboa" />
  <title>The Double-Ellipsoid Geometry of CLIP</title>

  <!-- Fonts & Icons -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&family=Roboto:wght@400;500&display=swap" rel="stylesheet">
  <script src="https://kit.fontawesome.com/ad96f96272.js" crossorigin="anonymous"></script>

  <style>
    :root {
      --accent: #a259ff;
      --accent-2: #6f2da8;
      --bg: #fafafa;
      --card: linear-gradient(145deg,#ffffff,#f2f0ff);
    }
    html,body { height:100%; }
    body {
      font-family: "Roboto", sans-serif;
      margin:0;
      padding-top:70px;
      background:var(--bg);
      color:#222;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }
    h1,h2,h3 { font-family: "Poppins", sans-serif; margin:0; }
    a { color:#4b0082; text-decoration:none; transition:0.2s; }
    a:hover { color:var(--accent); }

    /* Top nav */
    .topnav {
      position:fixed; top:0; left:0; right:0;
      background:var(--accent); z-index:1000;
      display:flex; justify-content:center; gap:6px;
      padding:10px; box-shadow:0 4px 8px rgba(0,0,0,0.08);
    }
    .topnav a { color:#fff; padding:8px 12px; font-weight:600; border-radius:6px; }
    .topnav a:hover { background: rgba(255,255,255,0.08); }

    /* Sections */
    section {
      margin:20px 0; padding:44px 5%;
      border-radius:18px;
      max-width:1100px; margin-left:auto; margin-right:auto;
      background:var(--card);
      box-shadow:0 10px 22px rgba(162,89,255,0.12);
    }
    .section-content { max-width:1000px; margin:0 auto; }

    h1 { font-size:2.6rem; color:var(--accent); font-weight:800; text-align:center; }
    h2 { font-size:1.8rem; color:#3b0066; margin-bottom:12px; text-align:center; }
    p, li { font-size:1.05rem; line-height:1.6; color:#333; margin:0 0 12px 0; }

    /* Hero specifics */
    #hero .hero-inner { display:flex; flex-direction:column; align-items:center; gap:12px; }
    .subtitle { color:#401a66; font-weight:600; margin-top:2px; }

    /* Small, delicate video placed right under the header/title */
    .hero-video-wrapper { margin-top:8px; display:flex; justify-content:center; width:100%; }
    .hero-video-inner {
      width:100%;
      max-width:520px; /* small & delicate */
      border-radius:12px;
      overflow:hidden;
      border:1px solid rgba(162,89,255,0.08);
      box-shadow:0 6px 18px rgba(162,89,255,0.06);
      background:#000;
      transition: transform 0.28s ease, opacity 0.28s ease;
      opacity:0.95;
    }
    .hero-video-inner.delicate { transform: translateY(0); opacity:1; }

    #hero-video { display:block; width:100%; height:auto; cursor:pointer; background:#000; }
    .video-overlay { position:absolute; inset:0; display:flex; align-items:center; justify-content:center; pointer-events:none; }
    .play-button {
      pointer-events:auto;
      display:flex; align-items:center; justify-content:center;
      width:56px; height:56px; border-radius:50%;
      background: rgba(0,0,0,0.46);
      color: #fff; font-size:20px;
      border:1px solid rgba(255,255,255,0.12);
      transition: transform 0.12s, background 0.12s, opacity 0.12s;
    }
    .play-button:hover { transform: scale(1.06); background: rgba(0,0,0,0.6); }
    .play-button.hidden { opacity:0; pointer-events:none; }

    /* Author portraits and buttons (below video) */
    .authors-container { display:flex; gap:28px; align-items:center; justify-content:center; margin-top:12px; flex-wrap:wrap; }
    .author { display:flex; flex-direction:column; align-items:center; }
    .author img { width:64px; height:64px; border-radius:50%; object-fit:cover; box-shadow:0 6px 12px rgba(0,0,0,0.06); }
    .btn-row { display:flex; gap:10px; justify-content:center; flex-wrap:wrap; margin-top:10px; }
    .btn-custom { display:inline-flex; gap:8px; align-items:center; padding:6px 12px; border-radius:8px; background:var(--accent); color:#fff; font-weight:600; text-decoration:none; }

    /* Abstract & teaser layout */
    .abstract-container { display:flex; gap:18px; align-items:stretch; justify-content:center; flex-wrap:wrap; margin-top:12px; }
    .abstract-text, .abstract-teaser-wrapper { flex:1 1 45%; min-width:260px; display:flex; flex-direction:column; }
    .abstract-teaser-wrapper img { width:100%; max-width:420px; margin:auto; border-radius:12px; cursor:pointer; display:block; }

    /* Insights */
    .insights-grid { display:grid; gap:14px; grid-template-columns:1fr; }

    /* poster & iframe */
    .poster { width:100%; max-width:1000px; border-radius:12px; display:block; margin:16px auto; }

    /* Modal (image fullscreen) */
    .modal { display:none; position:fixed; inset:0; background:rgba(0,0,0,0.9); z-index:1200; align-items:center; justify-content:center; }
    .modal img { max-width:92%; max-height:92%; border-radius:10px; box-shadow:0 18px 44px rgba(0,0,0,0.7); }
    .modal .close { position:absolute; top:20px; right:28px; color:#fff; font-size:36px; background:transparent; border:none; cursor:pointer; }

    footer { text-align:center; padding:40px 20px; color:#555; }

    @media (max-width:900px) {
      h1 { font-size:2.2rem; }
      .hero-video-inner { max-width:420px; }
      .play-button { width:50px; height:50px; font-size:18px; }
      .abstract-text, .abstract-teaser-wrapper { flex-basis:100%; }
    }
  </style>
</head>
<body>

  <!-- Top Navigation -->
  <div class="topnav" role="navigation" aria-label="Main navigation">
    <a href="#hero">Home</a>
    <a href="#abstract">Abstract</a>
    <a href="#insights">Key Insights</a>
    <a href="#colab">Colab</a>
    <a href="#followup">Follow-up</a>
    <a href="#caltech">Caltech</a>
    <a href="#bibtex">BibTeX</a>
  </div>

  <!-- Hero -->
  <section id="hero" aria-label="Hero">
    <div class="section-content hero-inner">
      <h1>The Double-Ellipsoid Geometry of CLIP</h1>
      <div class="subtitle">ICML 2025</div>

      <!-- Small delicate video right under the header/title -->
      <div class="hero-video-wrapper" aria-hidden="false">
        <div class="hero-video-inner" id="hero-video-inner" role="group" aria-label="Teaser video">
          <video id="hero-video"
                 src="https://raw.githubusercontent.com/yossilevii100/double-ellipsoid-clip/main/misc/double_ellipsoid.mp4"
                 muted playsinline preload="metadata" aria-label="Short teaser video"></video>

          <div class="video-overlay" aria-hidden="true">
            <button class="play-button" id="hero-play-btn" aria-label="Play teaser">
              <i class="fas fa-play"></i>
            </button>
          </div>
        </div>
      </div>

      <!-- Authors & links appear below the video -->
      <div class="authors-container" aria-hidden="false">
        <div class="author">
          <a href="https://yossilevii100.github.io" title="Meir Yossef Levi">
            <img src="https://raw.githubusercontent.com/yossilevii100/double-ellipsoid-clip/main/misc/yossi.jfif" alt="Meir Yossef Levi portrait">
          </a>
          <a href="https://yossilevii100.github.io">Meir Yossef Levi</a>
        </div>
        <div class="author">
          <a href="https://guygilboa.net.technion.ac.il/" title="Guy Gilboa">
            <img src="https://raw.githubusercontent.com/yossilevii100/double-ellipsoid-clip/main/misc/guy.png" alt="Guy Gilboa portrait">
          </a>
          <a href="https://guygilboa.net.technion.ac.il/">Guy Gilboa</a>
        </div>
        <div class="author">
          <a href="https://www.technion.ac.il/en/" title="Technion">
            <img src="https://raw.githubusercontent.com/yossilevii100/double-ellipsoid-clip/main/misc/technion.png" alt="Technion logo">
          </a>
          <a href="https://www.technion.ac.il/en/">Technion</a>
        </div>
      </div>

      <div class="btn-row" role="toolbar" aria-label="Primary links">
        <a class="btn-custom" href="https://arxiv.org/abs/2411.14517" target="_blank" rel="noopener">ArXiv</a>
        <a class="btn-custom" href="https://github.com/yossilevii100/double-ellipsoid-clip" target="_blank" rel="noopener">Code</a>
        <a class="btn-custom" href="https://www.youtube.com/watch?v=4nJCuGGfirw" target="_blank" rel="noopener">Presentation</a>
      </div>
    </div>
  </section>

  <!-- Abstract + Teaser -->
  <section id="abstract" aria-label="Abstract">
    <div class="section-content">
      <h2>Abstract</h2>
      <div class="abstract-container">
        <div class="abstract-text">
          <p>
            Contrastive Language–Image Pre-Training (CLIP) is instrumental across many domains, yet its embedding geometry is not fully understood. We examine the <strong>raw (pre-normalized)</strong> features and show that image and text reside on <strong>linearly separable ellipsoid shells</strong>, both <strong>shifted away from the origin</strong>. We introduce a notion of <em>conformity</em> and relate it to the modality gap and narrow-cone effect.
          </p>
        </div>
        <div class="abstract-teaser-wrapper">
          <img id="abstract-teaser" src="https://raw.githubusercontent.com/yossilevii100/double-ellipsoid-clip/main/misc/clip_poster.png" alt="Abstract teaser poster">
        </div>
      </div>
    </div>
  </section>

  <!-- Key Insights -->
  <section id="insights" aria-label="Key Insights">
    <div class="section-content">
      <h2>Key Insights</h2>
      <div class="insights-grid">
        <div class="card-insight">
          <h3>Double-Ellipsoid Geometry</h3>
          <p>Image and text features occupy distinct, shifted ellipsoid shells in the raw CLIP space; their separability explains the <em>modality gap</em>.</p>
        </div>
        <div class="card-insight">
          <h3>Conformity ≈ Mean-Similarity</h3>
          <p>A sample's conformity—the average cosine similarity to all others—can be estimated by its cosine similarity to the modality mean.</p>
        </div>
        <div class="card-insight">
          <h3>Practical Implications</h3>
          <p>Understanding this geometry suggests simple diagnostics and alignment improvements for downstream tasks.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Colab -->
  <section id="colab" aria-label="Colab demo">
    <div class="section-content">
      <h2>Try it in Colab</h2>
      <p>Open the demo notebook:</p>
      <a class="btn-custom" href="https://colab.research.google.com/gist/yossilevii100/aa3ca61e69ff5e1c0cd9cd6ddebd612e/untitled3.ipynb" target="_blank" rel="noopener">Open Colab Notebook</a>
      <pre>git clone https://github.com/yossilevii100/double-ellipsoid-clip.git
cd double-ellipsoid-clip
pip install -r requirements.txt</pre>
    </div>
  </section>

  <!-- Follow-up -->
  <section id="followup" aria-label="Follow-up">
    <div class="section-content">
      <h2>Follow-up Work</h2>
      <p>Check our ICML 2025 follow-up on probabilistic analysis of CLIP:</p>
      <a class="btn-custom" href="https://arxiv.org/abs/2505.06934" target="_blank" rel="noopener">arXiv (2505.06934)</a>
    </div>
  </section>

  <!-- Caltech Talk -->
  <section id="caltech" aria-label="Caltech Talk">
    <div class="section-content">
      <h2>Talk in Vision Lab, Caltech (Perona's Lab)</h2>
      <p>Watch the full one-hour talk:</p>
      <iframe src="https://drive.google.com/file/d/13G6lymCSy6RgKj4VmaGgePG2L3qkqWIB/preview" title="Caltech Talk" frameborder="0" allowfullscreen style="width:100%;height:450px;border-radius:12px;"></iframe>
    </div>
  </section>

  <!-- BibTeX -->
  <section id="bibtex" aria-label="BibTeX">
    <div class="section-content">
      <h2>BibTeX</h2>
      <pre>@inproceedings{levi2025double,
  title={The Double-Ellipsoid Geometry of CLIP},
  author={Levi, Meir Yossef and Gilboa, Guy},
  booktitle={International Conference on Machine Learning},
  year={2025}
}</pre>
    </div>
  </section>

  <footer>
    &copy; 2025 Meir Yossef Levi &amp; Guy Gilboa
  </footer>

  <!-- Modal for poster -->
  <div class="modal" id="modal" aria-hidden="true" role="dialog" aria-label="Poster preview">
    <button class="close" id="modal-close" aria-label="Close poster">&times;</button>
    <img id="modal-img" src="" alt="Expanded poster">
  </div>

  <script>
    // -------------------------
    // Poster modal (click poster to open)
    // -------------------------
    (function(){
      const teaser = document.getElementById('abstract-teaser');
      const modal = document.getElementById('modal');
      const modalImg = document.getElementById('modal-img');
      const closeBtn = document.getElementById('modal-close');

      function openModal(src, alt) {
        modalImg.src = src;
        modalImg.alt = alt || '';
        modal.style.display = 'flex';
        modal.setAttribute('aria-hidden', 'false');
        closeBtn.focus();
      }
      function closeModal() {
        modal.style.display = 'none';
        modal.setAttribute('aria-hidden', 'true');
        modalImg.src = '';
      }

      teaser && teaser.addEventListener('click', () => openModal(teaser.src, teaser.alt));
      closeBtn && closeBtn.addEventListener('click', closeModal);
      modal.addEventListener('click', (e) => { if (e.target === modal) closeModal(); });
      document.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeModal(); });
    })();

    // -------------------------
    // Small delicate hero video: autoplay once when visible (>=60%) + click to play
    // -------------------------
    (function(){
      const video = document.getElementById('hero-video');
      const playBtn = document.getElementById('hero-play-btn');
      const wrapper = document.getElementById('hero-video-inner');
      let playedThisView = false;

      // Try to autoplay (may be blocked on some browsers). If blocked, keep play button visible.
      function tryPlay() {
        if (!video) return;
        try { video.currentTime = 0; } catch(e){/*ignore*/}
        const playPromise = video.play();
        if (playPromise && typeof playPromise.then === 'function') {
          playPromise.then(() => {
            // success
          }).catch(() => {
            // autoplay blocked — keep play button visible for user
            playBtn.classList.remove('hidden');
          });
        }
      }

      // User-initiated play (click or button)
      function userPlay() {
        tryPlay();
        playedThisView = true;
        playBtn.classList.add('hidden');
      }

      // Clicking the overlay button or the video replays/plays
      playBtn.addEventListener('click', (e) => { e.stopPropagation(); userPlay(); });
      video.addEventListener('click', () => { userPlay(); });

      // Hide overlay when video starts playing
      video.addEventListener('playing', () => {
        playBtn.classList.add('hidden');
        wrapper.classList.add('delicate'); // subtle class for any effect
      });

      // Add keyboard accessibility for the play button
      playBtn.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); userPlay(); }
      });

      // IntersectionObserver: play once when >= 60% visible. Reset when fully out of view.
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.target !== video) return;
          if (entry.isIntersecting && entry.intersectionRatio >= 0.6) {
            if (!playedThisView) {
              tryPlay();
              playedThisView = true;
            }
          } else if (!entry.isIntersecting) {
            // reset when not visible so it can trigger again on next view
            playedThisView = false;
            playBtn.classList.remove('hidden'); // show play button again
          }
        });
      }, { threshold: [0, 0.2, 0.6, 1.0] });

      // start observing
      observer.observe(video);
    })();

    // optional: smooth scroll for nav links
    (function(){
      const links = document.querySelectorAll('.topnav a[href^="#"]');
      links.forEach(l => l.addEventListener('click', (e) => {
        e.preventDefault();
        const id = l.getAttribute('href').slice(1);
        const el = document.getElementById(id);
        if (el) el.scrollIntoView({ behavior:'smooth', block:'start' });
      }));
    })();
  </script>
</body>
</html>
